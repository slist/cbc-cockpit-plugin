<!DOCTYPE html>
<html>
  <head>
    <title>VMware Carbon Black Cloud</title>
    <meta charset="utf-8">
    <link href="../base1/cockpit.css" type="text/css" rel="stylesheet">
    <script src="../base1/cockpit.js"></script>
  </head>
  <body>
    <div class="pf-c-page">
      <main class="pf-c-page__main" tabindex="-1">
	<img src="./cbc.png" width="258">
	<section class="pf-c-page__main-section pf-m-light">
	  <table width="100%">
	    <tr style="vertical-align:top">
	      <td valign="top">Global configuration
		<hr>
		<table>

		  <tr width="100%">
		    <td><label class="control label" id="Service">Service</td>
		    <td><a href="/system/services#/cbagentd.service" target="_blank">cbagentd</a></label></td>
		  </tr>

		  <tr>
		    <td><button class="pf-c-button pf-m-primary" id="sensor_version">Sensor version</button></td>
		    <td><span id="result_sensor_version"></span></td>
		  </tr>

		  <tr>
		    <td><button class="pf-c-button pf-m-primary" id="kernel_version">Linux Kernel version</button></td>
		    <td><span id="result_kernel_version"></span></td>
		  </tr>

<!--		  <tr>
		    <td><button class="pf-c-button pf-m-primary" id="uninstall">Uninstall sensor (TODO)</button></td>
		    <td><span id="result_uninstall"></span></td>
		  </tr>
-->
		  <tr>
		    <td><button class="pf-c-button pf-m-primary" id="header">Check kernel header<br>(minimum required for eBPF : 4.4)</button></td>
		    <td><span id="result_header"></span></td>
		  </tr>

		  <tr>
		    <td><button class="pf-c-button pf-m-primary" id="cfg">cfg.ini</button></td>
		  </tr>

		  <tr>
		    <td><button class="pf-c-button pf-m-primary" id="diag">Diag</button></td>
		  </tr>

		  <tr>
		    <td><button class="pf-c-button pf-m-primary" id="repcli">repcli status</button></td>
		  </tr>

		</table>
	      </td>

	      <td>&nbsp;</td>

	      <td valign="top">NGAV : Endpoint Standard
	        <hr>
		<button class="pf-c-button pf-m-primary" id="syslog">CB syslog messages</button>
		<br>
		<button class="pf-c-button pf-m-primary" id="scan_log">Scan log</button>
	      </td>

	      <td>&nbsp;</td>

	      <td valign="top">Audit &amp; Remediation : osquery
		<hr>
		<button class="pf-c-button pf-m-primary" id="live_query_log">live_query_log</button>
	      </td>
	      <td>&nbsp;</td>
	      <td valign="top">EDR : Enterprise EDR
		<hr>
		<button class="pf-c-button pf-m-primary" id="events_average">events-average</button>
		<br>
		<button class="pf-c-button pf-m-primary" id="events_detail">events-detail</button>
		<br>
		<button class="pf-c-button pf-m-primary" id="bpf_event_collector">bpf_event_collector.log</button>
	      </td>
	    </tr>
	  </table>
	  <hr>
	  <pre id="output"></pre>
	</section>
      </main>
    </div>
    <script src="cbc.js"></script>
  </body>
</html>

